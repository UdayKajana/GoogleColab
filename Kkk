[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.


FROM python:3.9-slim
FROM apache/beam_python3.9_sdk:2.48.0
WORKDIR /workspace
RUN apt-get update && apt-get install -y \
build-essential \
libffi-dev \
libssl-dev \
wget \
&& apt-get clean \
&& rm -rf /var/lib/apt/lists/*
COPY requirements.txt /workspace/requirements.txt
RUN pip install --upgrade pip && pip install --no-cache-dir -r /workspace/requirements.txt
RUN apt-get update && apt-get install -y wget && \
    wget -O /opt/google/dataflow/python_template_launcher https://storage.googleapis.com/dataflow-flex-templates/python/launcher/python_template_launcher && \
    chmod +x /opt/google/dataflow/python_template_launcher
COPY dfpipeline.py /workspace/pipeline.py
ENTRYPOINT ["/opt/google/dataflow/python_template_launcher"]
