import logging
import sys
import argparse
logging.basicConfig(stream=sys.stdout, level=logging.INFO)
import apache_beam as beam
from apache_beam.transforms.sql import SqlTransform
from apache_beam.transforms.external import JavaJarExpansionService
from apache_beam.options.pipeline_options import PipelineOptions



parser = argparse.ArgumentParser()
parser.add_argument('--project', dest='project', required=True, help='Project ID')
parser.add_argument('--runner', dest='runner', required=False, default="DataflowRunner", help='Pipeline runner')
parser.add_argument('--region', dest='region', required=False, default="us-east4", help='GCP project region')
parser.add_argument('--staging_location', dest='staging_location', required=True, help='Staging GCS bucket path')
parser.add_argument('--temp_location', dest='temp_location', required=True, help='Temp GCS bucket path')
# parser.add_argument('--template_location', dest='template_location', required=True, help='GCS bucket path to save template')


known_args, beam_args = parser.parse_known_args()

options = {
    'project': known_args.project,
    'runner': known_args.runner,
    'region': known_args.region,
    'staging_location': known_args.staging_location,
    'temp_location': known_args.temp_location,
    # 'template_location': known_args.template_location,
    'save_main_session': True,
    'streaming': False
}

pipeline_options = PipelineOptions.from_dictionary(options)
p = beam.Pipeline(options=pipeline_options)

expansion_service = JavaJarExpansionService("/app/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar")

es=expansion_service.__enter__()

with beam.Pipeline(options=pipeline_options) as p:

    pc = (
            p
            | beam.Create([
                ["pie", "strawberry", 3, 1.5],
                ["muffin", "blueberry", 2, 2.],
                        ])
            # |beam.Map(print)
          # )
        | beam.Map(lambda x: beam.Row(recipe = str(x[0]),
                                 fruit = str(x[1]),
                                 quantity = int(x[2]),
                                 unit_cost = float(x[3]),
                                 is_berry = bool(x[1].endswith('berry')))))


    # pc | SqlTransform("SELECT * FROM PCOLLECTION WHERE quantity > 1",expansion_service="63.21.113.231:50768")
    pc | SqlTransform("SELECT * FROM PCOLLECTION WHERE quantity > 1", expansion_service="localhost:50768")
    # pc | SqlTransform("SELECT * FROM PCOLLECTION WHERE quantity > 1")
    pc | "printing" >> beam.Map(print)

Running the Python script...
INFO:apache_beam.typehints.native_type_compatibility:Using Any for unsupported type: typing.Sequence[~T]
INFO:apache_beam.utils.subprocess_server:Using cached job server jar from /app/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar
INFO:root:Starting a JAR-based expansion service from JAR /root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar 
INFO:apache_beam.utils.subprocess_server:Starting service with ['java' '-jar' '/root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar' '37065' '--filesToStage=/root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar']
INFO:apache_beam.utils.subprocess_server:Starting expansion service at localhost:37065
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:12:13 AM org.apache.beam.sdk.expansion.service.ExpansionService loadRegisteredTransforms
INFO:apache_beam.utils.subprocess_server:INFO: Registering external transforms: [beam:transform:org.apache.beam:spanner_insert_or_update:v1, beam:directrunner:transforms:test_stream:v1, beam:transform:org.apache.beam:pubsublite_write:v1, beam:transform:org.apache.beam:kafka_write:v1, beam:transform:combine_grouped_values:v1, beam:transform:combine_globally:v1, beam:external:java:generate_sequence:v1, beam:schematransform:org.apache.beam:bigquery_storage_read:v1, beam:transform:redistribute_by_key:v1, beam:directrunner:transforms:gabw:v1, beam:transform:window_into:v1, beam:transform:org.apache.beam:spanner_update:v1, beam:transform:org.apache.beam:pubsub_write:v1, beam:schematransform:org.apache.beam:kafka_read:v1, beam:schematransform:org.apache.beam:kafka_write:v1, beam:transform:combine_per_key:v1, beam:schematransform:org.apache.beam:bigquery_write:v1, beam:transform:org.apache.beam:kafka_read_with_metadata:v1, beam:transform:group_by_key:v1, beam:transform:pubsub_read:v1, beam:transform:org.apache.beam:spanner_delete:v1, beam:transform:group_into_batches:v1, beam:transform:org.apache.beam:spanner_read:v1, beam:transform:pubsub_write:v1, beam:transform:org.apache.beam:spanner_insert:v1, beam:transform:pubsub_write:v2, beam:transform:group_into_batches_with_sharded_key:v1, beam:transform:create_view:v1, beam:transform:teststream:v1, beam:transform:sdf_process_keyed_elements:v1, beam:transform:org.apache.beam:pubsub_read:v1, beam:external:java:sql:v1, beam:directrunner:transforms:write_view:v1, beam:transform:org.apache.beam:spanner_replace:v1, beam:directrunner:transforms:gbko:v1, beam:transform:org.apache.beam:pubsublite_read:v1, beam:transform:org.apache.beam:bigquery_write:v1, beam:transform:impulse:v1, beam:transform:flatten:v1, beam:runners_core:transforms:splittable_process:v1, beam:transform:write_files:v1, beam:directrunner:transforms:stateful_pardo:v1, beam:transform:org.apache.beam:bigquery_read:v1, beam:transform:org.apache.beam:kafka_read_without_metadata:v1, beam:transform:redistribute_arbitrarily:v1, beam:transform:reshuffle:v1]
INFO:apache_beam.utils.subprocess_server:
INFO:apache_beam.utils.subprocess_server:Registered transforms:
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_insert_or_update:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@55dfcc6
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:test_stream:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@222eb8aa
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsublite_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@93cf163
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@1852a3ff
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_grouped_values:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@7203c7ff
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_globally:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@25bfcafd
INFO:apache_beam.utils.subprocess_server:       beam:external:java:generate_sequence:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@4b6690c0
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@46268f08
INFO:apache_beam.utils.subprocess_server:       beam:transform:redistribute_by_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@2a76840c
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:gabw:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@71454b9d
INFO:apache_beam.utils.subprocess_server:       beam:transform:window_into:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@eda25e5
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_update:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@7cf6a5f9
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsub_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@623e088f
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@39fcbef6
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@66565121
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_per_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@2fc6f97f
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@3d2ee678
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_read_with_metadata:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@6179e425
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_by_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@35f26e72
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@2d6764b2
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_delete:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@67304a40
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_into_batches:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@49c6c24f
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@6fe1b4fb
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@79351f41
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_insert:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@1c32386d
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_write:v2: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@6399551e
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_into_batches_with_sharded_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@13d73fa
INFO:apache_beam.utils.subprocess_server:       beam:transform:create_view:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5023bb8b
INFO:apache_beam.utils.subprocess_server:       beam:transform:teststream:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5d5f10b2
INFO:apache_beam.utils.subprocess_server:       beam:transform:sdf_process_keyed_elements:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@74c79fa2
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsub_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@1e0f9063
INFO:apache_beam.utils.subprocess_server:       beam:external:java:sql:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@53bd8fca
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:write_view:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@7642df8f
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_replace:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@3e30646a
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:gbko:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5cde6747
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsublite_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@63a270c9
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:bigquery_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@37c7595
INFO:apache_beam.utils.subprocess_server:       beam:transform:impulse:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@3ed242a4
INFO:apache_beam.utils.subprocess_server:       beam:transform:flatten:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1199fe66
INFO:apache_beam.utils.subprocess_server:       beam:runners_core:transforms:splittable_process:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@614df0a4
INFO:apache_beam.utils.subprocess_server:       beam:transform:write_files:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1fdf1c5
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:stateful_pardo:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@2d96543c
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:bigquery_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@73a2e526
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_read_without_metadata:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@7d64e326
INFO:apache_beam.utils.subprocess_server:       beam:transform:redistribute_arbitrarily:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@13f95696
INFO:apache_beam.utils.subprocess_server:       beam:transform:reshuffle:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@cd1d761
INFO:apache_beam.utils.subprocess_server:
INFO:apache_beam.utils.subprocess_server:Registered SchemaTransformProviders:
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_fileloads:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:filter-java:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:flatten:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_cdc_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:map_to_fields-java:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigtable_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:log_for_testing:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsublite_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_export_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_write:v2
INFO:apache_beam.utils.subprocess_server:       schematransform:org.apache.beam:sql_transform:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsub_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsub_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:window_into_strategy:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigtable_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsublite_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:generate_sequence:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:explode:v1
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1736410334.576101     510 fork_posix.cc:77] Other threads are currently calling into gRPC, skipping fork() handlers
I0000 00:00:1736410334.588675     510 fork_posix.cc:77] Other threads are currently calling into gRPC, skipping fork() handlers
INFO:apache_beam.utils.subprocess_server:Using cached job server jar from https://repo.maven.apache.org/maven2/org/apache/beam/beam-sdks-java-extensions-sql-expansion-service/2.61.0/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar
INFO:root:Starting a JAR-based expansion service from JAR /root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar 
INFO:apache_beam.utils.subprocess_server:Starting service with ['java' '-jar' '/root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar' '57989' '--filesToStage=/root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar' '--alsoStartLoopbackWorker']
I0000 00:00:1736410334.603706     510 fork_posix.cc:77] Other threads are currently calling into gRPC, skipping fork() handlers
INFO:apache_beam.utils.subprocess_server:Starting expansion service at localhost:57989
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:12:16 AM org.apache.beam.sdk.expansion.service.ExpansionService loadRegisteredTransforms
INFO:apache_beam.utils.subprocess_server:INFO: Registering external transforms: [beam:transform:org.apache.beam:spanner_insert_or_update:v1, beam:directrunner:transforms:test_stream:v1, beam:transform:org.apache.beam:pubsublite_write:v1, beam:transform:org.apache.beam:kafka_write:v1, beam:transform:combine_grouped_values:v1, beam:transform:combine_globally:v1, beam:external:java:generate_sequence:v1, beam:schematransform:org.apache.beam:bigquery_storage_read:v1, beam:transform:redistribute_by_key:v1, beam:transform:window_into:v1, beam:directrunner:transforms:gabw:v1, beam:transform:org.apache.beam:spanner_update:v1, beam:transform:org.apache.beam:pubsub_write:v1, beam:schematransform:org.apache.beam:kafka_read:v1, beam:schematransform:org.apache.beam:kafka_write:v1, beam:transform:combine_per_key:v1, beam:schematransform:org.apache.beam:bigquery_write:v1, beam:transform:org.apache.beam:kafka_read_with_metadata:v1, beam:transform:group_by_key:v1, beam:transform:pubsub_read:v1, beam:transform:org.apache.beam:spanner_delete:v1, beam:transform:group_into_batches:v1, beam:transform:org.apache.beam:spanner_read:v1, beam:transform:pubsub_write:v1, beam:transform:org.apache.beam:spanner_insert:v1, beam:transform:pubsub_write:v2, beam:transform:group_into_batches_with_sharded_key:v1, beam:transform:create_view:v1, beam:transform:teststream:v1, beam:transform:sdf_process_keyed_elements:v1, beam:transform:org.apache.beam:pubsub_read:v1, beam:external:java:sql:v1, beam:directrunner:transforms:write_view:v1, beam:transform:org.apache.beam:spanner_replace:v1, beam:directrunner:transforms:gbko:v1, beam:transform:org.apache.beam:pubsublite_read:v1, beam:transform:org.apache.beam:bigquery_write:v1, beam:transform:impulse:v1, beam:transform:flatten:v1, beam:transform:write_files:v1, beam:runners_core:transforms:splittable_process:v1, beam:directrunner:transforms:stateful_pardo:v1, beam:transform:org.apache.beam:bigquery_read:v1, beam:transform:org.apache.beam:kafka_read_without_metadata:v1, beam:transform:reshuffle:v1, beam:transform:redistribute_arbitrarily:v1]
INFO:apache_beam.utils.subprocess_server:
INFO:apache_beam.utils.subprocess_server:Registered transforms:
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_insert_or_update:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@614df0a4
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:test_stream:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1fdf1c5
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsublite_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@2d96543c
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@73a2e526
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_grouped_values:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@7d64e326
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_globally:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@13f95696
INFO:apache_beam.utils.subprocess_server:       beam:external:java:generate_sequence:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@cd1d761
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@68be8808
INFO:apache_beam.utils.subprocess_server:       beam:transform:redistribute_by_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@32193bea
INFO:apache_beam.utils.subprocess_server:       beam:transform:window_into:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@6b8d96d9
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:gabw:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@69653e16
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_update:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@758705fa
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsub_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@ebaa6cb
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@906d29b
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@49d3c823
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_per_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@436bc36
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5fe1ce85
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_read_with_metadata:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@604c5de8
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_by_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@37091312
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@66fdec9
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_delete:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@57abad67
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_into_batches:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@550a1967
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@2a640157
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@52851b44
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_insert:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@584f54e6
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_write:v2: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5d8bafa9
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_into_batches_with_sharded_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@576f63f6
INFO:apache_beam.utils.subprocess_server:       beam:transform:create_view:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@2dca0d64
INFO:apache_beam.utils.subprocess_server:       beam:transform:teststream:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@f80945f
INFO:apache_beam.utils.subprocess_server:       beam:transform:sdf_process_keyed_elements:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@ff684e1
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsub_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@23aa363a
INFO:apache_beam.utils.subprocess_server:       beam:external:java:sql:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@5ef6ae06
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:write_view:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@55dfebeb
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_replace:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@6e35bc3d
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:gbko:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1cdc4c27
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsublite_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@77b14724
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:bigquery_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5d9b7a8a
INFO:apache_beam.utils.subprocess_server:       beam:transform:impulse:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1e8ce150
INFO:apache_beam.utils.subprocess_server:       beam:transform:flatten:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@604f2bd2
INFO:apache_beam.utils.subprocess_server:       beam:transform:write_files:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1d3ac898
INFO:apache_beam.utils.subprocess_server:       beam:runners_core:transforms:splittable_process:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1b73be9f
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:stateful_pardo:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@628c4ac0
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:bigquery_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@7b84fcf8
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_read_without_metadata:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@30b19518
INFO:apache_beam.utils.subprocess_server:       beam:transform:reshuffle:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@363042d7
INFO:apache_beam.utils.subprocess_server:       beam:transform:redistribute_arbitrarily:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@366ac49b
INFO:apache_beam.utils.subprocess_server:
INFO:apache_beam.utils.subprocess_server:Registered SchemaTransformProviders:
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_fileloads:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:filter-java:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:flatten:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_cdc_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:map_to_fields-java:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigtable_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:log_for_testing:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsublite_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_export_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_write:v2
INFO:apache_beam.utils.subprocess_server:       schematransform:org.apache.beam:sql_transform:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsub_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsub_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:window_into_strategy:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigtable_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsublite_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:generate_sequence:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:explode:v1
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:12:17 AM org.apache.beam.sdk.expansion.service.ExpansionService expand
INFO:apache_beam.utils.subprocess_server:INFO: Expanding 'SqlTransform(beam:external:java:sql:v1)' with URN 'beam:external:java:sql:v1'
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:12:17 AM org.apache.beam.sdk.expansion.service.ExpansionService payloadToConfig
INFO:apache_beam.utils.subprocess_server:WARNING: Configuration class 'org.apache.beam.sdk.extensions.sql.expansion.ExternalSqlTransformRegistrar$Configuration' has no schema registered. Attempting to construct with setter approach.
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:12:17 AM org.apache.beam.sdk.expansion.service.ExpansionService payloadToConfig
INFO:apache_beam.utils.subprocess_server:WARNING: Configuration class 'org.apache.beam.sdk.extensions.sql.expansion.ExternalSqlTransformRegistrar$Configuration' has no schema registered. Attempting to construct with setter approach.
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:12:18 AM org.apache.beam.sdk.extensions.sql.impl.CalciteQueryPlanner convertToBeamRel
INFO:apache_beam.utils.subprocess_server:INFO: SQL:
INFO:apache_beam.utils.subprocess_server:SELECT `PCOLLECTION`.`recipe`, `PCOLLECTION`.`fruit`, `PCOLLECTION`.`quantity`, `PCOLLECTION`.`unit_cost`, `PCOLLECTION`.`is_berry`
INFO:apache_beam.utils.subprocess_server:FROM `beam`.`PCOLLECTION` AS `PCOLLECTION`
INFO:apache_beam.utils.subprocess_server:WHERE `PCOLLECTION`.`quantity` > 1
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:12:18 AM org.apache.beam.sdk.extensions.sql.impl.CalciteQueryPlanner convertToBeamRel
INFO:apache_beam.utils.subprocess_server:INFO: SQLPlan>
INFO:apache_beam.utils.subprocess_server:LogicalProject(recipe=[$0], fruit=[$1], quantity=[$2], unit_cost=[$3], is_berry=[$4])
INFO:apache_beam.utils.subprocess_server:  LogicalFilter(condition=[>($2, 1)])
INFO:apache_beam.utils.subprocess_server:    BeamIOSourceRel(table=[[beam, PCOLLECTION]])
INFO:apache_beam.utils.subprocess_server:
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:12:19 AM org.apache.beam.sdk.extensions.sql.impl.CalciteQueryPlanner convertToBeamRel
INFO:apache_beam.utils.subprocess_server:INFO: BEAMPlan>
INFO:apache_beam.utils.subprocess_server:BeamCalcRel(expr#0..4=[{inputs}], expr#5=[1], expr#6=[>($t2, $t5)], proj#0..4=[{exprs}], $condition=[$t6])
INFO:apache_beam.utils.subprocess_server:  BeamIOSourceRel(table=[[beam, PCOLLECTION]])
INFO:apache_beam.utils.subprocess_server:
Traceback (most recent call last):
  File "/app/pipeline.py", line 61, in <module>
    pc | "printing" >> beam.Map(print)
  File "/usr/local/lib/python3.9/site-packages/apache_beam/pipeline.py", line 620, in __exit__
    self.result = self.run()
  File "/usr/local/lib/python3.9/site-packages/apache_beam/pipeline.py", line 591, in run
    pickler.dump_session(os.path.join(tmpdir, 'main_session.pickle'))
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/pickler.py", line 60, in dump_session
    return desired_pickle_lib.dump_session(file_path)
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 443, in dump_session
    dill.dump_session(file_path)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 351, in dump_session
    pickler.dump(main)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 445, in dump
    StockPickler.dump(self, obj)
  File "/usr/local/lib/python3.9/pickle.py", line 487, in dump
    self.save(obj)
  File "/usr/local/lib/python3.9/pickle.py", line 560, in save
    f(self, obj)  # Call unbound method with explicit self
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 308, in save_module
    return old_save_module(pickler, obj)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 1294, in save_module
    pickler.save_reduce(_import_module, (obj.__name__,), obj=obj,
  File "/usr/local/lib/python3.9/pickle.py", line 717, in save_reduce
    save(state)
  File "/usr/local/lib/python3.9/pickle.py", line 560, in save
    f(self, obj)  # Call unbound method with explicit self
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 355, in new_save_module_dict
    return old_save_module_dict(pickler, obj)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 912, in save_module_dict
    StockPickler.save_dict(pickler, obj)
  File "/usr/local/lib/python3.9/pickle.py", line 971, in save_dict
    self._batch_setitems(obj.items())
  File "/usr/local/lib/python3.9/pickle.py", line 997, in _batch_setitems
    save(v)
  File "/usr/local/lib/python3.9/pickle.py", line 603, in save
    self.save_reduce(obj=obj, *rv)
  File "/usr/local/lib/python3.9/pickle.py", line 717, in save_reduce
    save(state)
  File "/usr/local/lib/python3.9/pickle.py", line 560, in save
    f(self, obj)  # Call unbound method with explicit self
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 355, in new_save_module_dict
    return old_save_module_dict(pickler, obj)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 912, in save_module_dict
    StockPickler.save_dict(pickler, obj)
  File "/usr/local/lib/python3.9/pickle.py", line 971, in save_dict
    self._batch_setitems(obj.items())
  File "/usr/local/lib/python3.9/pickle.py", line 997, in _batch_setitems
    save(v)
  File "/usr/local/lib/python3.9/pickle.py", line 603, in save
    self.save_reduce(obj=obj, *rv)
  File "/usr/local/lib/python3.9/pickle.py", line 717, in save_reduce
    save(state)
  File "/usr/local/lib/python3.9/pickle.py", line 560, in save
    f(self, obj)  # Call unbound method with explicit self
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 355, in new_save_module_dict
    return old_save_module_dict(pickler, obj)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 912, in save_module_dict
    StockPickler.save_dict(pickler, obj)
  File "/usr/local/lib/python3.9/pickle.py", line 971, in save_dict
    self._batch_setitems(obj.items())
  File "/usr/local/lib/python3.9/pickle.py", line 997, in _batch_setitems
    save(v)
  File "/usr/local/lib/python3.9/pickle.py", line 603, in save
    self.save_reduce(obj=obj, *rv)
  File "/usr/local/lib/python3.9/pickle.py", line 717, in save_reduce
    save(state)
  File "/usr/local/lib/python3.9/pickle.py", line 560, in save
    f(self, obj)  # Call unbound method with explicit self
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 355, in new_save_module_dict
    return old_save_module_dict(pickler, obj)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 912, in save_module_dict
    StockPickler.save_dict(pickler, obj)
  File "/usr/local/lib/python3.9/pickle.py", line 971, in save_dict
    self._batch_setitems(obj.items())
  File "/usr/local/lib/python3.9/pickle.py", line 997, in _batch_setitems
    save(v)
  File "/usr/local/lib/python3.9/pickle.py", line 578, in save
    rv = reduce(self.proto)
  File "stringsource", line 2, in grpc._cython.cygrpc.Channel.__reduce_cython__
TypeError: no default __reduce__ due to non-trivial __cinit__
bash-4.4# docker rm container
container
bash-4.4# docker build -t service:v1 /workspace1/
Sending build context to Docker daemon  6.274MB
Step 1/10 : FROM gcr.io/dataflow-templates-base/python39-template-launcher-base
 ---> 28ccded4eb25
Step 2/10 : WORKDIR /app
 ---> Using cache
 ---> 5adeed48cc29
Step 3/10 : RUN apt-get update && apt-get install -y     libffi-dev     libssl-dev     && apt-get clean     && rm -rf /var/lib/apt/lists/*
 ---> Using cache
 ---> 8591e336ec78
Step 4/10 : RUN gsutil cp gs://vznet-test/wireline_churn_test/expansion_service/jdk_17.deb /app/
 ---> Using cache
 ---> 85117113969a
Step 5/10 : RUN chmod +x jdk_17.deb
 ---> Using cache
 ---> f8154081341d
Step 6/10 : RUN dpkg -i jdk_17.deb
 ---> Using cache
 ---> 32e93ead8f13
Step 7/10 : RUN java --version
 ---> Using cache
 ---> 1676bbab5919
Step 8/10 : COPY entrypoint.sh /app/entrypoint.sh
 ---> Using cache
 ---> 75d0b97cad6a
Step 9/10 : RUN chmod +x /app/entrypoint.sh
 ---> Using cache
 ---> 54321b406431
Step 10/10 : ENTRYPOINT ["/app/entrypoint.sh"]
 ---> Using cache
 ---> c747c09ed2ae
Successfully built c747c09ed2ae
Successfully tagged service:v1
bash-4.4# docker run -it --name container  service:v1


Updates are available for some Google Cloud CLI components.  To install them,
please run:
  $ gcloud components update

Copying gs://vznet-test/wireline_churn_test/expansion_service/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar...
- [1 files][308.9 MiB/308.9 MiB]                                                
Operation completed over 1 objects/308.9 MiB.                                    
Copying gs://vznet-test/wireline_churn_test/expansion_service/pipeline.py...
/ [1 files][  2.5 KiB/  2.5 KiB]                                                
Operation completed over 1 objects/2.5 KiB.                                      
total 316360
-rw-r--r--. 1 root root 323950398 Jan  9 08:13 beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar
Starting the JAR application...
Running the Python script...
INFO:apache_beam.typehints.native_type_compatibility:Using Any for unsupported type: typing.Sequence[~T]
INFO:apache_beam.utils.subprocess_server:Using cached job server jar from /app/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar
INFO:root:Starting a JAR-based expansion service from JAR /root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar 
INFO:apache_beam.utils.subprocess_server:Starting service with ['java' '-jar' '/root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar' '54211' '--filesToStage=/root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar']
INFO:apache_beam.utils.subprocess_server:Starting expansion service at localhost:54211
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:13:28 AM org.apache.beam.sdk.expansion.service.ExpansionService loadRegisteredTransforms
INFO:apache_beam.utils.subprocess_server:INFO: Registering external transforms: [beam:transform:org.apache.beam:spanner_insert_or_update:v1, beam:directrunner:transforms:test_stream:v1, beam:transform:org.apache.beam:pubsublite_write:v1, beam:transform:org.apache.beam:kafka_write:v1, beam:transform:combine_grouped_values:v1, beam:transform:combine_globally:v1, beam:external:java:generate_sequence:v1, beam:schematransform:org.apache.beam:bigquery_storage_read:v1, beam:transform:redistribute_by_key:v1, beam:directrunner:transforms:gabw:v1, beam:transform:window_into:v1, beam:transform:org.apache.beam:spanner_update:v1, beam:transform:org.apache.beam:pubsub_write:v1, beam:schematransform:org.apache.beam:kafka_read:v1, beam:schematransform:org.apache.beam:kafka_write:v1, beam:transform:combine_per_key:v1, beam:schematransform:org.apache.beam:bigquery_write:v1, beam:transform:org.apache.beam:kafka_read_with_metadata:v1, beam:transform:group_by_key:v1, beam:transform:pubsub_read:v1, beam:transform:org.apache.beam:spanner_delete:v1, beam:transform:group_into_batches:v1, beam:transform:org.apache.beam:spanner_read:v1, beam:transform:pubsub_write:v1, beam:transform:org.apache.beam:spanner_insert:v1, beam:transform:pubsub_write:v2, beam:transform:group_into_batches_with_sharded_key:v1, beam:transform:create_view:v1, beam:transform:teststream:v1, beam:transform:sdf_process_keyed_elements:v1, beam:transform:org.apache.beam:pubsub_read:v1, beam:external:java:sql:v1, beam:directrunner:transforms:write_view:v1, beam:transform:org.apache.beam:spanner_replace:v1, beam:directrunner:transforms:gbko:v1, beam:transform:org.apache.beam:pubsublite_read:v1, beam:transform:org.apache.beam:bigquery_write:v1, beam:transform:impulse:v1, beam:transform:flatten:v1, beam:runners_core:transforms:splittable_process:v1, beam:transform:write_files:v1, beam:directrunner:transforms:stateful_pardo:v1, beam:transform:org.apache.beam:bigquery_read:v1, beam:transform:org.apache.beam:kafka_read_without_metadata:v1, beam:transform:redistribute_arbitrarily:v1, beam:transform:reshuffle:v1]
INFO:apache_beam.utils.subprocess_server:
INFO:apache_beam.utils.subprocess_server:Registered transforms:
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_insert_or_update:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@55dfcc6
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:test_stream:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@222eb8aa
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsublite_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@93cf163
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@1852a3ff
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_grouped_values:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@7203c7ff
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_globally:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@25bfcafd
INFO:apache_beam.utils.subprocess_server:       beam:external:java:generate_sequence:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@4b6690c0
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@46268f08
INFO:apache_beam.utils.subprocess_server:       beam:transform:redistribute_by_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@2a76840c
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:gabw:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@71454b9d
INFO:apache_beam.utils.subprocess_server:       beam:transform:window_into:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@eda25e5
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_update:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@7cf6a5f9
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsub_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@623e088f
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@39fcbef6
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@66565121
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_per_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@2fc6f97f
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@3d2ee678
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_read_with_metadata:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@6179e425
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_by_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@35f26e72
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@2d6764b2
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_delete:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@67304a40
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_into_batches:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@49c6c24f
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@6fe1b4fb
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@79351f41
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_insert:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@1c32386d
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_write:v2: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@6399551e
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_into_batches_with_sharded_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@13d73fa
INFO:apache_beam.utils.subprocess_server:       beam:transform:create_view:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5023bb8b
INFO:apache_beam.utils.subprocess_server:       beam:transform:teststream:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5d5f10b2
INFO:apache_beam.utils.subprocess_server:       beam:transform:sdf_process_keyed_elements:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@74c79fa2
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsub_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@1e0f9063
INFO:apache_beam.utils.subprocess_server:       beam:external:java:sql:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@53bd8fca
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:write_view:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@7642df8f
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_replace:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@3e30646a
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:gbko:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5cde6747
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsublite_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@63a270c9
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:bigquery_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@37c7595
INFO:apache_beam.utils.subprocess_server:       beam:transform:impulse:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@3ed242a4
INFO:apache_beam.utils.subprocess_server:       beam:transform:flatten:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1199fe66
INFO:apache_beam.utils.subprocess_server:       beam:runners_core:transforms:splittable_process:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@614df0a4
INFO:apache_beam.utils.subprocess_server:       beam:transform:write_files:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1fdf1c5
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:stateful_pardo:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@2d96543c
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:bigquery_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@73a2e526
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_read_without_metadata:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@7d64e326
INFO:apache_beam.utils.subprocess_server:       beam:transform:redistribute_arbitrarily:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@13f95696
INFO:apache_beam.utils.subprocess_server:       beam:transform:reshuffle:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@cd1d761
INFO:apache_beam.utils.subprocess_server:
INFO:apache_beam.utils.subprocess_server:Registered SchemaTransformProviders:
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_fileloads:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:filter-java:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:flatten:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_cdc_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:map_to_fields-java:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigtable_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:log_for_testing:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsublite_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_export_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_write:v2
INFO:apache_beam.utils.subprocess_server:       schematransform:org.apache.beam:sql_transform:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsub_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsub_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:window_into_strategy:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigtable_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsublite_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:generate_sequence:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:explode:v1
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1736410409.507824     510 fork_posix.cc:77] Other threads are currently calling into gRPC, skipping fork() handlers
I0000 00:00:1736410409.521259     510 fork_posix.cc:77] Other threads are currently calling into gRPC, skipping fork() handlers
INFO:apache_beam.utils.subprocess_server:Using cached job server jar from https://repo.maven.apache.org/maven2/org/apache/beam/beam-sdks-java-extensions-sql-expansion-service/2.61.0/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar
INFO:root:Starting a JAR-based expansion service from JAR /root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar 
INFO:apache_beam.utils.subprocess_server:Starting service with ['java' '-jar' '/root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar' '36229' '--filesToStage=/root/.apache_beam/cache/jars/beam-sdks-java-extensions-sql-expansion-service-2.61.0.jar' '--alsoStartLoopbackWorker']
I0000 00:00:1736410409.536867     510 fork_posix.cc:77] Other threads are currently calling into gRPC, skipping fork() handlers
INFO:apache_beam.utils.subprocess_server:Starting expansion service at localhost:36229
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:13:31 AM org.apache.beam.sdk.expansion.service.ExpansionService loadRegisteredTransforms
INFO:apache_beam.utils.subprocess_server:INFO: Registering external transforms: [beam:transform:org.apache.beam:spanner_insert_or_update:v1, beam:directrunner:transforms:test_stream:v1, beam:transform:org.apache.beam:pubsublite_write:v1, beam:transform:org.apache.beam:kafka_write:v1, beam:transform:combine_grouped_values:v1, beam:transform:combine_globally:v1, beam:external:java:generate_sequence:v1, beam:schematransform:org.apache.beam:bigquery_storage_read:v1, beam:transform:redistribute_by_key:v1, beam:transform:window_into:v1, beam:directrunner:transforms:gabw:v1, beam:transform:org.apache.beam:spanner_update:v1, beam:transform:org.apache.beam:pubsub_write:v1, beam:schematransform:org.apache.beam:kafka_read:v1, beam:schematransform:org.apache.beam:kafka_write:v1, beam:transform:combine_per_key:v1, beam:schematransform:org.apache.beam:bigquery_write:v1, beam:transform:org.apache.beam:kafka_read_with_metadata:v1, beam:transform:group_by_key:v1, beam:transform:pubsub_read:v1, beam:transform:org.apache.beam:spanner_delete:v1, beam:transform:group_into_batches:v1, beam:transform:org.apache.beam:spanner_read:v1, beam:transform:pubsub_write:v1, beam:transform:org.apache.beam:spanner_insert:v1, beam:transform:pubsub_write:v2, beam:transform:group_into_batches_with_sharded_key:v1, beam:transform:create_view:v1, beam:transform:teststream:v1, beam:transform:sdf_process_keyed_elements:v1, beam:transform:org.apache.beam:pubsub_read:v1, beam:external:java:sql:v1, beam:directrunner:transforms:write_view:v1, beam:transform:org.apache.beam:spanner_replace:v1, beam:directrunner:transforms:gbko:v1, beam:transform:org.apache.beam:pubsublite_read:v1, beam:transform:org.apache.beam:bigquery_write:v1, beam:transform:impulse:v1, beam:transform:flatten:v1, beam:transform:write_files:v1, beam:runners_core:transforms:splittable_process:v1, beam:directrunner:transforms:stateful_pardo:v1, beam:transform:org.apache.beam:bigquery_read:v1, beam:transform:org.apache.beam:kafka_read_without_metadata:v1, beam:transform:reshuffle:v1, beam:transform:redistribute_arbitrarily:v1]
INFO:apache_beam.utils.subprocess_server:
INFO:apache_beam.utils.subprocess_server:Registered transforms:
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_insert_or_update:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@614df0a4
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:test_stream:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1fdf1c5
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsublite_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@2d96543c
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@73a2e526
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_grouped_values:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@7d64e326
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_globally:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@13f95696
INFO:apache_beam.utils.subprocess_server:       beam:external:java:generate_sequence:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@cd1d761
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@68be8808
INFO:apache_beam.utils.subprocess_server:       beam:transform:redistribute_by_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@32193bea
INFO:apache_beam.utils.subprocess_server:       beam:transform:window_into:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@6b8d96d9
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:gabw:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@69653e16
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_update:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@758705fa
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsub_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@ebaa6cb
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@906d29b
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@49d3c823
INFO:apache_beam.utils.subprocess_server:       beam:transform:combine_per_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@436bc36
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5fe1ce85
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_read_with_metadata:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@604c5de8
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_by_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@37091312
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@66fdec9
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_delete:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@57abad67
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_into_batches:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@550a1967
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@2a640157
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@52851b44
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_insert:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@584f54e6
INFO:apache_beam.utils.subprocess_server:       beam:transform:pubsub_write:v2: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5d8bafa9
INFO:apache_beam.utils.subprocess_server:       beam:transform:group_into_batches_with_sharded_key:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@576f63f6
INFO:apache_beam.utils.subprocess_server:       beam:transform:create_view:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@2dca0d64
INFO:apache_beam.utils.subprocess_server:       beam:transform:teststream:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@f80945f
INFO:apache_beam.utils.subprocess_server:       beam:transform:sdf_process_keyed_elements:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@ff684e1
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsub_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@23aa363a
INFO:apache_beam.utils.subprocess_server:       beam:external:java:sql:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@5ef6ae06
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:write_view:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@55dfebeb
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:spanner_replace:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@6e35bc3d
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:gbko:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1cdc4c27
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:pubsublite_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@77b14724
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:bigquery_write:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@5d9b7a8a
INFO:apache_beam.utils.subprocess_server:       beam:transform:impulse:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1e8ce150
INFO:apache_beam.utils.subprocess_server:       beam:transform:flatten:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@604f2bd2
INFO:apache_beam.utils.subprocess_server:       beam:transform:write_files:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1d3ac898
INFO:apache_beam.utils.subprocess_server:       beam:runners_core:transforms:splittable_process:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@1b73be9f
INFO:apache_beam.utils.subprocess_server:       beam:directrunner:transforms:stateful_pardo:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@628c4ac0
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:bigquery_read:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@7b84fcf8
INFO:apache_beam.utils.subprocess_server:       beam:transform:org.apache.beam:kafka_read_without_metadata:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForBuilder@30b19518
INFO:apache_beam.utils.subprocess_server:       beam:transform:reshuffle:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@363042d7
INFO:apache_beam.utils.subprocess_server:       beam:transform:redistribute_arbitrarily:v1: org.apache.beam.sdk.expansion.service.ExpansionService$TransformProviderForPayloadTranslator@366ac49b
INFO:apache_beam.utils.subprocess_server:
INFO:apache_beam.utils.subprocess_server:Registered SchemaTransformProviders:
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_fileloads:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:filter-java:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:flatten:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_cdc_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:map_to_fields-java:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigtable_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:log_for_testing:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsublite_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:spanner_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_export_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:kafka_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_storage_write:v2
INFO:apache_beam.utils.subprocess_server:       schematransform:org.apache.beam:sql_transform:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsub_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsub_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:window_into_strategy:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigtable_read:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:bigquery_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:pubsublite_write:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:generate_sequence:v1
INFO:apache_beam.utils.subprocess_server:       beam:schematransform:org.apache.beam:yaml:explode:v1
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:13:32 AM org.apache.beam.sdk.expansion.service.ExpansionService expand
INFO:apache_beam.utils.subprocess_server:INFO: Expanding 'SqlTransform(beam:external:java:sql:v1)' with URN 'beam:external:java:sql:v1'
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:13:32 AM org.apache.beam.sdk.expansion.service.ExpansionService payloadToConfig
INFO:apache_beam.utils.subprocess_server:WARNING: Configuration class 'org.apache.beam.sdk.extensions.sql.expansion.ExternalSqlTransformRegistrar$Configuration' has no schema registered. Attempting to construct with setter approach.
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:13:32 AM org.apache.beam.sdk.expansion.service.ExpansionService payloadToConfig
INFO:apache_beam.utils.subprocess_server:WARNING: Configuration class 'org.apache.beam.sdk.extensions.sql.expansion.ExternalSqlTransformRegistrar$Configuration' has no schema registered. Attempting to construct with setter approach.
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:13:33 AM org.apache.beam.sdk.extensions.sql.impl.CalciteQueryPlanner convertToBeamRel
INFO:apache_beam.utils.subprocess_server:INFO: SQL:
INFO:apache_beam.utils.subprocess_server:SELECT `PCOLLECTION`.`recipe`, `PCOLLECTION`.`fruit`, `PCOLLECTION`.`quantity`, `PCOLLECTION`.`unit_cost`, `PCOLLECTION`.`is_berry`
INFO:apache_beam.utils.subprocess_server:FROM `beam`.`PCOLLECTION` AS `PCOLLECTION`
INFO:apache_beam.utils.subprocess_server:WHERE `PCOLLECTION`.`quantity` > 1
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:13:33 AM org.apache.beam.sdk.extensions.sql.impl.CalciteQueryPlanner convertToBeamRel
INFO:apache_beam.utils.subprocess_server:INFO: SQLPlan>
INFO:apache_beam.utils.subprocess_server:LogicalProject(recipe=[$0], fruit=[$1], quantity=[$2], unit_cost=[$3], is_berry=[$4])
INFO:apache_beam.utils.subprocess_server:  LogicalFilter(condition=[>($2, 1)])
INFO:apache_beam.utils.subprocess_server:    BeamIOSourceRel(table=[[beam, PCOLLECTION]])
INFO:apache_beam.utils.subprocess_server:
INFO:apache_beam.utils.subprocess_server:Jan 09, 2025 8:13:33 AM org.apache.beam.sdk.extensions.sql.impl.CalciteQueryPlanner convertToBeamRel
INFO:apache_beam.utils.subprocess_server:INFO: BEAMPlan>
INFO:apache_beam.utils.subprocess_server:BeamCalcRel(expr#0..4=[{inputs}], expr#5=[1], expr#6=[>($t2, $t5)], proj#0..4=[{exprs}], $condition=[$t6])
INFO:apache_beam.utils.subprocess_server:  BeamIOSourceRel(table=[[beam, PCOLLECTION]])
INFO:apache_beam.utils.subprocess_server:
Traceback (most recent call last):
  File "/app/pipeline.py", line 61, in <module>
    pc | "printing" >> beam.Map(print)
  File "/usr/local/lib/python3.9/site-packages/apache_beam/pipeline.py", line 620, in __exit__
    self.result = self.run()
  File "/usr/local/lib/python3.9/site-packages/apache_beam/pipeline.py", line 591, in run
    pickler.dump_session(os.path.join(tmpdir, 'main_session.pickle'))
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/pickler.py", line 60, in dump_session
    return desired_pickle_lib.dump_session(file_path)
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 443, in dump_session
    dill.dump_session(file_path)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 351, in dump_session
    pickler.dump(main)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 445, in dump
    StockPickler.dump(self, obj)
  File "/usr/local/lib/python3.9/pickle.py", line 487, in dump
    self.save(obj)
  File "/usr/local/lib/python3.9/pickle.py", line 560, in save
    f(self, obj)  # Call unbound method with explicit self
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 308, in save_module
    return old_save_module(pickler, obj)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 1294, in save_module
    pickler.save_reduce(_import_module, (obj.__name__,), obj=obj,
  File "/usr/local/lib/python3.9/pickle.py", line 717, in save_reduce
    save(state)
  File "/usr/local/lib/python3.9/pickle.py", line 560, in save
    f(self, obj)  # Call unbound method with explicit self
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 355, in new_save_module_dict
    return old_save_module_dict(pickler, obj)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 912, in save_module_dict
    StockPickler.save_dict(pickler, obj)
  File "/usr/local/lib/python3.9/pickle.py", line 971, in save_dict
    self._batch_setitems(obj.items())
  File "/usr/local/lib/python3.9/pickle.py", line 997, in _batch_setitems
    save(v)
  File "/usr/local/lib/python3.9/pickle.py", line 603, in save
    self.save_reduce(obj=obj, *rv)
  File "/usr/local/lib/python3.9/pickle.py", line 717, in save_reduce
    save(state)
  File "/usr/local/lib/python3.9/pickle.py", line 560, in save
    f(self, obj)  # Call unbound method with explicit self
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 355, in new_save_module_dict
    return old_save_module_dict(pickler, obj)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 912, in save_module_dict
    StockPickler.save_dict(pickler, obj)
  File "/usr/local/lib/python3.9/pickle.py", line 971, in save_dict
    self._batch_setitems(obj.items())
  File "/usr/local/lib/python3.9/pickle.py", line 997, in _batch_setitems
    save(v)
  File "/usr/local/lib/python3.9/pickle.py", line 603, in save
    self.save_reduce(obj=obj, *rv)
  File "/usr/local/lib/python3.9/pickle.py", line 717, in save_reduce
    save(state)
  File "/usr/local/lib/python3.9/pickle.py", line 560, in save
    f(self, obj)  # Call unbound method with explicit self
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 355, in new_save_module_dict
    return old_save_module_dict(pickler, obj)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 912, in save_module_dict
    StockPickler.save_dict(pickler, obj)
  File "/usr/local/lib/python3.9/pickle.py", line 971, in save_dict
    self._batch_setitems(obj.items())
  File "/usr/local/lib/python3.9/pickle.py", line 997, in _batch_setitems
    save(v)
  File "/usr/local/lib/python3.9/pickle.py", line 603, in save
    self.save_reduce(obj=obj, *rv)
  File "/usr/local/lib/python3.9/pickle.py", line 717, in save_reduce
    save(state)
  File "/usr/local/lib/python3.9/pickle.py", line 560, in save
    f(self, obj)  # Call unbound method with explicit self
  File "/usr/local/lib/python3.9/site-packages/apache_beam/internal/dill_pickler.py", line 355, in new_save_module_dict
    return old_save_module_dict(pickler, obj)
  File "/usr/local/lib/python3.9/site-packages/dill/_dill.py", line 912, in save_module_dict
    StockPickler.save_dict(pickler, obj)
  File "/usr/local/lib/python3.9/pickle.py", line 971, in save_dict
    self._batch_setitems(obj.items())
  File "/usr/local/lib/python3.9/pickle.py", line 997, in _batch_setitems
    save(v)
  File "/usr/local/lib/python3.9/pickle.py", line 578, in save
    rv = reduce(self.proto)
  File "stringsource", line 2, in grpc._cython.cygrpc.Channel.__reduce_cython__
TypeError: no default __reduce__ due to non-trivial __cinit__
bash-4.4# 
